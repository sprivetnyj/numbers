(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var i=n.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})(),e.p;const t={Click:new Howl({src:"./audio/click.wav",html5:!0})},n=["\n++1|\n6++|\n\t","\n++1|\n+51|\n+++|\n\t","\n-++|\n814|\n+++|\n\t"],i={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return i.Android()||i.BlackBerry()||i.iOS()||i.Opera()||i.Windows()}};vkBridge.send("VKWebAppInit");const o=document.querySelector("canvas");o.getContext("2d");const s=640/360;o.width=360,o.height=640;let c=1;const r=document.querySelector(".wrapper"),a=document.querySelectorAll(".screen"),d=(document.querySelector(".screen--start"),document.querySelector(".screen--game")),l=(document.querySelector(".screen--end"),document.querySelector(".play")),u=document.querySelector(".group"),m=document.querySelector(".post"),h=document.querySelector(".invite"),g=document.querySelector(".volume"),v=document.querySelector(".preloader");let f=!0;v.classList.add("hidden");let p,y,L,w,x,E,b,S,A,k=0,q=!1;function B(){const e=n[k].replace(/\r?\n/g,"").trim();let t=0;for(let n of e)"|"===n&&t++;const o=e.indexOf("|");let s;switch(o){case 3:s=40;break;case 4:s=30;break;case 5:s=20}let c=`<div class="grid" style="--columns:${o};--rows:${t};--width:340px;--height:${340/o*t}px;--size:${s}px">\n`;for(let t of e)if("|"!==t){let e="",n="";"+"!==t&&"-"!==t?(t=Number(t),e=t,n=1===t?"start active":"end"):"-"===t&&(n="hidden"),c=c.concat(`<div class="grid__item ${n}">${e}</div>\n`)}c=c.concat("</div>"),d.insertAdjacentHTML("afterbegin",c),p=document.querySelector(".grid"),y=document.querySelectorAll(".grid__item"),L=document.querySelectorAll(".grid__item.start"),w=1,x=0,y.forEach((e=>{e.classList.contains("hidden")||x++})),i.any()?L.forEach((e=>{e.addEventListener("touchstart",(()=>{E=[e],document.addEventListener("touchmove",W),document.addEventListener("touchend",$)}))})):L.forEach((e=>{e.addEventListener("mousedown",(()=>{E=[e],document.addEventListener("mousemove",W),document.addEventListener("mouseup",$)}))}))}B(),O(d),document.addEventListener("click",(e=>{const n=e.target;if(n===l)O(d);else if(n===u)vkBridge.send("VKWebAppJoinGroup",{group_id:213140436});else if(n===m){let e=10;vkBridge.send("VKWebAppShowWallPostBox",{message:`Мой уровень в игре Game - ${e}! Сможешь побить?\n\nOrby Games (vk.com/orby.games) - бесплатные игры для ВКонтакте. Присоединяйся!\n\n#игры #vkgames #directgames`,attachments:"https://vk.com/appID"})}else n===h?vkBridge.send("VKWebAppShowInviteBox"):n===g&&(f=!f,g.classList.toggle("off"));var i,o;n.closest("button")&&(vkBridge.send("VKWebAppTapticImpactOccurred",{style:"light"}),i=[n.closest("button")],200,o="scale",i.forEach((e=>{e.classList.add(o),setTimeout((()=>{e.classList.remove(o)}),200)})),f&&t.Click.play())}));let C=!0;function W(e){if(!q){if(i.any()){const t=e.touches[0],n=document.elementFromPoint(t.clientX,t.clientY);b=n}else b=e.target;if(b.closest(".grid")){if(b.classList.contains("start")||b.classList.contains("active")||(b.classList.contains("hidden")?$():(S=E[E.length-1].getBoundingClientRect(),A=b.getBoundingClientRect(),A.x<S.x&&A.y>S.y||A.x<S.x&&A.y<S.y||A.x>S.x&&A.y>S.y||A.x>S.x&&A.y<S.y?$():b.classList.contains("end")?b.textContent==w+1?(T(),p.querySelectorAll(".start").length>1&&E.forEach((e=>{e.classList.add("completed")})),p.querySelectorAll(".end.completed").length&&(i.any()?document.removeEventListener("touchmove",W):document.removeEventListener("mousemove",W)),setTimeout((()=>{q||(vkBridge.send("VKWebAppTapticImpactOccurred",{style:"medium"}),confetti({particleCount:50,decay:c/1.5,ticks:40,spread:360,gravity:0,scalar:c,colors:["#fe5cd7"],origin:{x:(A.x+41.25*c)/window.innerWidth,y:(A.y+41.25*c)/window.innerHeight}}))}),1)):(C&&E.forEach((e=>{e.classList.add("error","delay"),setTimeout((()=>{e.classList.remove("error")}),200),setTimeout((()=>{e.classList.remove("delay")}),400)})),C=!1):C?(T(),b.textContent=w):$())),b.classList.contains("active")&&(w-1==b.textContent?y.forEach((e=>{e.textContent==w&&E.includes(e)&&setTimeout((()=>{w--,C=!0,e.classList.remove("active","top","left","right","bottom"),E.splice(E.indexOf(e),1),e.classList.contains("end")||(e.textContent="")}),1)})):w>b.textContent&&$()),p.querySelectorAll(".active").length>=x&&!q){k++,setTimeout((()=>{i.any()?document.removeEventListener("touchmove",W):document.removeEventListener("mousemove",W),p.remove(),B(),q=!1}),2e3),q=!0;const e=["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"];confetti({particleCount:100,angle:60,spread:90,gravity:1.5,origin:{x:0,y:.6},colors:e}),confetti({particleCount:100,angle:120,spread:90,gravity:1.5,origin:{x:1,y:.6},colors:e}),vkBridge.send("VKWebAppTapticImpactOccurred",{style:"heavy"})}}else $()}}function T(){A.y>S.y&&b.classList.add("top"),A.y<S.y&&b.classList.add("bottom"),A.x>S.x&&b.classList.add("left"),A.x<S.x&&b.classList.add("right"),E.push(b),b.classList.add("active"),w++}function $(){q||(C=!0,w=1,E.forEach((e=>{e.classList.remove("error")})),E=[],i.any()?document.removeEventListener("touchmove",W):document.removeEventListener("mousemove",W),y.forEach((e=>{e.classList.contains("completed")||e.classList.remove("active","top","left","right","bottom"),e.classList.contains("start")&&e.classList.add("active"),e.classList.contains("start")||e.classList.contains("end")||e.classList.contains("completed")||(e.textContent="")})))}function O(e){a.forEach((t=>{let n="hidden--left",i="hidden--right";e.classList.contains("hidden--left")&&(n="hidden--right",i="hidden--left"),t.classList.contains("hidden")?t===e&&H([t],"remove",["hidden",i],0):H([t],"add",["hidden",n],0)}))}function H(e,t,n,i=0){setTimeout((()=>{e.forEach((e=>{n.forEach((n=>{"add"===t?e.classList.add(n):e.classList.remove(n)}))}))}),i)}function I(){const e=window.innerHeight/window.innerWidth;s>e?(o.width=window.innerHeight/s,o.height=window.innerHeight,c=window.innerHeight/640,r.style=`--scale:${c}`):(o.width=window.innerWidth,o.height=window.innerWidth*s,c=window.innerWidth/360,r.style=`--scale:${c}`)}I(),window.addEventListener("resize",I)})();